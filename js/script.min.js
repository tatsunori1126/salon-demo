document.addEventListener("DOMContentLoaded",function(){let l=document.getElementById("reservation-modal");if(l){let n=document.getElementById("modal-calendar"),o,u="",a=0,r="",s="";l.addEventListener("click",e=>{var t=e.target.closest(".btn-week");t?(e.preventDefault(),"prev"===(t=t.dataset.week)&&a--,"next"===t&&a++,"today"===t&&(a=0),o=document.querySelector("#m-menu")?.value||document.querySelector("#res_menu")?.value||document.querySelector("#menu_key")?.value||"cut",u=document.querySelector("#m-staff")?.value||document.querySelector("#res_staff")?.value||document.querySelector("#staff_id")?.value||0,console.log("ğŸ“¤ é€ä¿¡ãƒ‡ãƒ¼ã‚¿:",{menu:o,staff:u,week:a}),(t=new FormData).append("action","salon_render_calendar_front"),t.append("menu",o),t.append("staff",u),t.append("week",a),t.append("mode","front"),n.innerHTML="èª­ã¿è¾¼ã¿ä¸­â€¦",fetch(salon_ajax.url,{method:"POST",body:t}).then(e=>e.text()).then(e=>{n.innerHTML=e;e=n.querySelectorAll(".slot-btn");console.log("slot-btn count:",e.length),e.forEach(d=>{d.addEventListener("click",()=>{r=d.dataset.date,s=d.dataset.time,u=d.dataset.staff;var e=document.querySelector("#your-name")||document.querySelector("#f-name"),t=document.querySelector("#your-email")||document.querySelector("#f-email"),n=document.querySelector("#your-tel")||document.querySelector("#f-tel"),o=document.querySelector("#m-menu")||document.querySelector("#res_menu")||document.querySelector("#menu_key"),o=o?.options?.[o.selectedIndex]?.textContent||"-",a=document.querySelector("#m-staff")||document.querySelector("#res_staff")||document.querySelector("#staff_id"),a=a?.options?.[a.selectedIndex]?.textContent||"è‡ªå‹•å‰²å½“",l=document.querySelector("#step-2"),c=document.querySelector("#step-3");document.getElementById("c-name").textContent=e?.value||"-",document.getElementById("c-email").textContent=t?.value||"-",document.getElementById("c-tel").textContent=n?.value||"-",document.getElementById("c-menu").textContent=o,document.getElementById("c-staff").textContent=a,document.getElementById("c-datetime").textContent=r+" "+s,l&&c?(l.style.display="none",c.style.display="block"):console.warn("step-2 ã¾ãŸã¯ step-3 ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“")})})}).catch(()=>{n.innerHTML="èª­ã¿è¾¼ã¿å¤±æ•—"})):(t=e.target.closest(".slot-btn"))&&(e.preventDefault(),l.querySelectorAll(".slot-btn.selected").forEach(e=>e.classList.remove("selected")),t.classList.add("selected"),r=t.dataset.date,s=t.dataset.time,u=t.dataset.staff,e="1"===t.dataset.autoassign?"è‡ªå‹•å‰²å½“":document.querySelector("#m-staff")?.selectedOptions?.[0]?.textContent||"-",console.log(`é¸æŠ: ${r} ${s} / ã‚¹ã‚¿ãƒƒãƒ•: `+e),document.getElementById("c-menu").textContent=document.querySelector("#m-menu")?.selectedOptions?.[0]?.textContent||"-",document.getElementById("c-staff").textContent=e,document.getElementById("c-datetime").textContent=r+" "+s,step2&&step3?(step2.style.display="none",step3.style.display="block"):console.warn("âš  step2 ã¾ãŸã¯ step3 ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“"))})}}),jQuery(function(o){let a=0;function t(){var e=o("#menu_key").val()||o("#res_menu").val()||"cut",t=o("#staff_id").val()||o("#res_staff").val()||3,n=(console.log("ğŸ“¤ é€ä¿¡ãƒ‡ãƒ¼ã‚¿:",{menuKey:e,staffId:t,currentWeek:a}),new FormData);n.append("action","salon_render_calendar_public_readonly"),n.append("menu_key",e),n.append("staff_id",t),n.append("week",a),fetch(salon_ajax.url,{method:"POST",body:n}).then(e=>e.text()).then(e=>{o("#readonly-calendar").html(e)}).catch(()=>alert("é€šä¿¡ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ"))}o.ajaxSetup({cache:!1}),o("body").off("click.salonNextWeek").on("click.salonNextWeek","#next-week",function(e){e.preventDefault(),a++,t()}),o("body").off("click.salonPrevWeek").on("click.salonPrevWeek","#prev-week",function(e){e.preventDefault(),a--,t()}),t()});