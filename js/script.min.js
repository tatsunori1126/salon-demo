document.addEventListener("DOMContentLoaded",function(){let d=document.getElementById("reservation-modal");if(d){let n=document.getElementById("modal-calendar"),o=0,t,l;d.addEventListener("click",e=>{var a=e.target.closest(".btn-week");if(a){e.preventDefault();a=a.dataset.week;"prev"===a&&o--,"next"===a&&o++,"today"===a&&(o=0);{a=new FormData;a.append("action","salon_render_calendar_front"),a.append("menu",""),a.append("staff",""),a.append("week",o),n.innerHTML=`
        <div class="modal-calendar-header" style="text-align:center; margin:10px 0;">
          <button type="button" class="btn-week" data-week="prev">← 前の週</button>
          <button type="button" class="btn-week is-today" data-week="today">今週</button>
          <button type="button" class="btn-week" data-week="next">次の週 →</button>
        </div>
        <div class="modal-calendar-body">読み込み中…</div>`;let t=n.querySelector(".modal-calendar-body");fetch(salon_ajax.url,{method:"POST",body:a}).then(e=>e.text()).then(e=>{t.innerHTML=e}).catch(()=>{t.innerHTML="読み込みに失敗しました"})}}else{a=e.target.closest(".slot-btn");a&&(e.preventDefault(),d.querySelectorAll(".slot-btn.selected").forEach(e=>e.classList.remove("selected")),a.classList.add("selected"),t=a.dataset.date,l=a.dataset.time,console.log(`選択: ${t} `+l))}})}}),jQuery(function(a){if(a("#calendar-wrapper").length){let t=0;function n(){a.ajax({url:ajaxurl,type:"POST",data:{action:"salon_calendar",menu_key:a("#menu_key").val(),staff_id:a("#staff_id").val(),week:t},success:function(e){a("#calendar-wrapper").html(e),console.log("表示中の週:",t)},error:function(e,t,a){console.error("Ajax error:",t,a)}})}a("body").off("click.salonNextWeek").on("click.salonNextWeek","#next-week",function(e){e.preventDefault(),t++,n()}),a("body").off("click.salonPrevWeek").on("click.salonPrevWeek","#prev-week",function(e){e.preventDefault(),t--,n()})}});